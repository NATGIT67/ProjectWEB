<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EasyRice Admin Panel</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="admin-wrapper">
        
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>EasyRice Admin</h2>
            </div>
            
            <nav class="sidebar-menu">
                <a href="admin.html" class="menu-item active"><i class="fas fa-home"></i> แดชบอร์ด</a>
                <a href="#" class="menu-item"><i class="fas fa-seedling"></i> จัดการสินค้า</a>
                <a href="#" class="menu-item"><i class="fas fa-calendar-alt"></i> การจอง</a>
                <a href="#" class="menu-item"><i class="fas fa-credit-card"></i> การชำระเงิน</a>
                <a href="index.html" class="menu-item logout"><i class="fas fa-power-off"></i> ออกจากระบบ</a>
            </nav>
        </aside>

        <main class="main-content">
            <div class="content-container">
                
                <div class="stats-grid">
                    <div class="stat-card card-yellow">
                        <h3>สินค้าทั้งหมด</h3>
                        <div class="stat-value" id="countTotal">0</div>
                    </div>
                    <div class="stat-card card-green">
                        <h3>สต็อกรวม (ถาด)</h3>
                        <div class="stat-value" id="countStock">0</div>
                    </div>
                    <div class="stat-card card-grey">
                        <h3>รอตรวจสอบ</h3>
                        <div class="stat-value">2</div>
                    </div>
                    <div class="stat-card card-orange">
                        <h3>คำสั่งซื้อวันนี้</h3>
                        <div class="stat-value">5</div>
                    </div>
                </div>

                <div class="table-card">
                    <div class="table-header-row">
                        <h3><i class="fas fa-boxes"></i> รายการสินค้าในระบบ</h3>
                        <button onclick="openModal()" class="btn-add-top">
                            <i class="fas fa-plus"></i> เพิ่มต้นกล้าใหม่
                        </button>
                    </div>

                    <div style="overflow-x: auto;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>รูปภาพ</th>
                                    <th>ชื่อพันธุ์ข้าว</th>
                                    <th>ราคา/ถาด</th>
                                    <th>เวลาปลูก (วัน)</th>
                                    <th>คงเหลือ</th>
                                    <th>จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="adminProductList">
                                </tbody>
                        </table>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <div id="productModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-seedling"></i> เพิ่มข้อมูลพันธุ์ข้าว</h3>
                <span class="close-modal" onclick="closeModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="addSeedlingForm">
                    <div class="form-group">
                        <label>ชื่อพันธุ์ข้าว</label>
                        <input type="text" id="pName" class="form-control" placeholder="เช่น ข้าวหอมมะลิ" required>
                    </div>
                    <div class="form-row-2">
                        <div class="form-group">
                            <label>ราคา (บาท)</label>
                            <input type="number" id="pPrice" class="form-control" placeholder="13" required>
                        </div>
                        <div class="form-group">
                            <label>เวลาเติบโต (วัน)</label>
                            <input type="number" id="pTime" class="form-control" placeholder="120" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>จำนวนสต็อก (ถาด)</label>
                        <input type="number" id="pStock" class="form-control" placeholder="0" required>
                    </div>
                    <div class="form-group">
                        <label>URL รูปภาพ</label>
                        <input type="text" id="pImg" class="form-control" placeholder="https://..." required>
                    </div>
                    <button type="submit" class="btn-save full-width">บันทึกข้อมูล</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // --- ส่วนจัดการข้อมูล (Logic) ---

        function loadAdminProducts() {
            // ดึงข้อมูล หรือ ใช้ค่าเริ่มต้น
            const products = JSON.parse(localStorage.getItem('easyrice_products')) || [
                { id: 1, name: 'ข้าวหอมมะลิ 105', price: 35, stock: 150, img: 'https://via.placeholder.com/100', time: 120 },
                { id: 2, name: 'ข้าวไรซ์เบอร์รี่', price: 45, stock: 25, img: 'https://via.placeholder.com/100', time: 130 }
            ];

            const tbody = document.getElementById('adminProductList');
            tbody.innerHTML = '';

            let totalStock = 0;

            products.forEach(p => {
                totalStock += parseInt(p.stock);
                tbody.innerHTML += `
                    <tr>
                        <td><img src="${p.img}" class="table-img"></td>
                        <td style="text-align:left; font-weight:500;">${p.name}</td>
                        <td>฿${p.price}</td>
                        <td>${p.time}</td>
                        <td><span class="stock-pill ${p.stock > 0 ? 'instock' : 'outstock'}">${p.stock}</span></td>
                        <td>
                            <button onclick="deleteProduct(${p.id})" class="btn-icon delete" title="ลบสินค้า"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                `;
            });

            // อัปเดตตัวเลขในกล่องสถิติ
            document.getElementById('countTotal').innerText = products.length;
            document.getElementById('countStock').innerText = totalStock.toLocaleString();

            if(!localStorage.getItem('easyrice_products')) {
                localStorage.setItem('easyrice_products', JSON.stringify(products));
            }
        }

        // เพิ่มสินค้าใหม่
        document.getElementById('addSeedlingForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const products = JSON.parse(localStorage.getItem('easyrice_products')) || [];
            
            const newProduct = {
                id: Date.now(),
                name: document.getElementById('pName').value,
                price: document.getElementById('pPrice').value,
                time: document.getElementById('pTime').value,
                stock: document.getElementById('pStock').value,
                img: document.getElementById('pImg').value
            };

            products.push(newProduct);
            localStorage.setItem('easyrice_products', JSON.stringify(products));
            
            alert('เพิ่มข้อมูลสำเร็จ!');
            this.reset();
            closeModal(); 
            loadAdminProducts(); 
        });

        // ลบสินค้า
        function deleteProduct(id) {
            if(confirm('ต้องการลบสินค้านี้ใช่หรือไม่?')) {
                let products = JSON.parse(localStorage.getItem('easyrice_products'));
                products = products.filter(p => p.id !== id);
                localStorage.setItem('easyrice_products', JSON.stringify(products));
                loadAdminProducts();
            }
        }

        // --- ส่วนจัดการ Modal ---
        const modal = document.getElementById('productModal');
        function openModal() { modal.style.display = 'flex'; }
        function closeModal() { modal.style.display = 'none'; }
        window.onclick = function(event) { if (event.target == modal) closeModal(); }

        window.onload = loadAdminProducts;
    </script>
</body>
</html>